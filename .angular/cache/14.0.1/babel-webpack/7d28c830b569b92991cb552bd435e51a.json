{"ast":null,"code":"import { MatPaginator } from \"@angular/material/paginator\";\nimport { MatSort } from \"@angular/material/sort\";\nimport { tap, catchError, finalize } from 'rxjs/operators';\nimport { merge, throwError } from 'rxjs';\nimport { SelectionModel } from '@angular/cdk/collections';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/courses.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/checkbox\";\nimport * as i5 from \"@angular/material/paginator\";\nimport * as i6 from \"@angular/material/progress-spinner\";\nimport * as i7 from \"@angular/material/sort\";\nimport * as i8 from \"@angular/material/table\";\n\nfunction CourseComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelement(1, \"mat-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CourseComponent_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"th\", 21)(1, \"mat-checkbox\", 22);\n    i0.ɵɵlistener(\"change\", function CourseComponent_th_8_Template_mat_checkbox_change_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.toggleAll());\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"checked\", ctx_r1.selection.hasValue() && ctx_r1.isAllSelected())(\"indeterminate\", ctx_r1.selection.hasValue() && !ctx_r1.isAllSelected());\n  }\n}\n\nfunction CourseComponent_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"td\", 23);\n    i0.ɵɵlistener(\"click\", function CourseComponent_td_9_Template_td_click_0_listener($event) {\n      return $event.stopPropagation();\n    });\n    i0.ɵɵelementStart(1, \"mat-checkbox\", 24);\n    i0.ɵɵlistener(\"change\", function CourseComponent_td_9_Template_mat_checkbox_change_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const lesson_r15 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.onLessonToggled(lesson_r15));\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const lesson_r15 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"checked\", ctx_r2.selection.isSelected(lesson_r15));\n  }\n}\n\nfunction CourseComponent_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 25);\n    i0.ɵɵtext(1, \"#\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CourseComponent_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const lesson_r19 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(lesson_r19.seqNo);\n  }\n}\n\nfunction CourseComponent_th_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 25);\n    i0.ɵɵtext(1, \"Description\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CourseComponent_td_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const lesson_r20 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(lesson_r20.description);\n  }\n}\n\nfunction CourseComponent_th_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 21);\n    i0.ɵɵtext(1, \"Duration\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CourseComponent_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const lesson_r21 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(lesson_r21.duration);\n  }\n}\n\nfunction CourseComponent_td_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 28);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const lesson_r22 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", lesson_r22.longDescription, \" \");\n  }\n}\n\nfunction CourseComponent_tr_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 29);\n  }\n}\n\nfunction CourseComponent_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 30);\n    i0.ɵɵlistener(\"click\", function CourseComponent_tr_22_Template_tr_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r25);\n      const lesson_r23 = restoredCtx.$implicit;\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.onToggleLesson(lesson_r23));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CourseComponent_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 31);\n  }\n\n  if (rf & 2) {\n    const lesson_r26 = ctx.$implicit;\n    const ctx_r12 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"collapsed-detail\", lesson_r26 != ctx_r12.expandedLesson);\n  }\n}\n\nconst _c0 = function () {\n  return [\"expandedDetail\"];\n};\n\nconst _c1 = function () {\n  return [3, 5, 10];\n};\n\nexport let CourseComponent = /*#__PURE__*/(() => {\n  class CourseComponent {\n    constructor(route, coursesService) {\n      this.route = route;\n      this.coursesService = coursesService;\n      this.lessons = [];\n      this.loading = false;\n      this.selection = new SelectionModel(true, []);\n      this.displayedColumns = ['select', 'seqNo', \"description\", \"duration\"];\n      this.expandedLesson = null;\n    }\n\n    ngOnInit() {\n      this.course = this.route.snapshot.data[\"course\"];\n      this.loadLessonsPage();\n    }\n\n    onLessonToggled(lesson) {\n      this.selection.toggle(lesson);\n      console.log(this.selection.selected);\n    }\n\n    loadLessonsPage() {\n      var _a, _b, _c, _d, _e, _f, _g, _h;\n\n      this.loading = true;\n      this.coursesService.findLessons(this.course.id, (_b = (_a = this.sort) === null || _a === void 0 ? void 0 : _a.direction) !== null && _b !== void 0 ? _b : \"asc\", (_d = (_c = this.paginator) === null || _c === void 0 ? void 0 : _c.pageIndex) !== null && _d !== void 0 ? _d : 0, (_f = (_e = this.paginator) === null || _e === void 0 ? void 0 : _e.pageSize) !== null && _f !== void 0 ? _f : 3, (_h = (_g = this.sort) === null || _g === void 0 ? void 0 : _g.active) !== null && _h !== void 0 ? _h : \"seqNo\").pipe(tap(lessons => this.lessons = lessons), catchError(err => {\n        console.log(\"Error loading lessons\", err);\n        alert(\"Error loading lessons.\");\n        return throwError(err);\n      }), finalize(() => this.loading = false)).subscribe();\n    }\n\n    onToggleLesson(lesson) {\n      if (lesson == this.expandedLesson) {\n        this.expandedLesson = null;\n      } else {\n        this.expandedLesson = lesson;\n      }\n    }\n\n    ngAfterViewInit() {\n      this.sort.sortChange.subscribe(() => this.paginator.pageIndex = 0);\n      merge(this.sort.sortChange, this.paginator.page).pipe(tap(() => this.loadLessonsPage())).subscribe();\n    }\n\n    isAllSelected() {\n      var _a, _b;\n\n      return ((_a = this.selection.selected) === null || _a === void 0 ? void 0 : _a.length) == ((_b = this.lessons) === null || _b === void 0 ? void 0 : _b.length);\n    }\n\n    toggleAll() {\n      if (this.isAllSelected()) {\n        this.selection.clear();\n      } else {\n        this.selection.select(...this.lessons);\n      }\n    }\n\n  }\n\n  CourseComponent.ɵfac = function CourseComponent_Factory(t) {\n    return new (t || CourseComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.CoursesService));\n  };\n\n  CourseComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CourseComponent,\n    selectors: [[\"course\"]],\n    viewQuery: function CourseComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(MatPaginator, 5);\n        i0.ɵɵviewQuery(MatSort, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n      }\n    },\n    decls: 25,\n    vars: 13,\n    consts: [[1, \"course\"], [1, \"course-thumbnail\", 3, \"src\"], [\"class\", \"spinner-container\", 4, \"ngIf\"], [1, \"scrolling-container\"], [\"mat-table\", \"\", \"matSort\", \"\", \"matSortDisableClear\", \"\", \"matSortActive\", \"seqNo\", \"matSortDirection\", \"asc\", \"multiTemplateDataRows\", \"\", 1, \"lessons-table\", \"mat-elevation-z8\", 3, \"dataSource\"], [\"matColumnDef\", \"select\", \"sticky\", \"\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 3, \"click\", 4, \"matCellDef\"], [\"matColumnDef\", \"seqNo\", \"sticky\", \"\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"description\"], [\"matColumnDef\", \"duration\"], [\"class\", \"duration-cell\", \"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"expandedDetail\"], [\"mat-cell\", \"\", \"colspan\", \"4\", 4, \"matCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\", \"matHeaderRowDefSticky\"], [\"mat-row\", \"\", 3, \"click\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-row\", \"\", 3, \"collapsed-detail\", 4, \"matRowDef\", \"matRowDefColumns\"], [1, \"mat-elevation-z8\", 3, \"length\", \"pageSize\", \"pageSizeOptions\"], [1, \"spinner-container\"], [\"mat-header-cell\", \"\"], [3, \"checked\", \"indeterminate\", \"change\"], [\"mat-cell\", \"\", 3, \"click\"], [3, \"checked\", \"change\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [\"mat-cell\", \"\", 1, \"duration-cell\"], [\"mat-cell\", \"\", \"colspan\", \"4\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\", 3, \"click\"], [\"mat-row\", \"\"]],\n    template: function CourseComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(3, \"img\", 1);\n        i0.ɵɵtemplate(4, CourseComponent_div_4_Template, 2, 0, \"div\", 2);\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"table\", 4);\n        i0.ɵɵelementContainerStart(7, 5);\n        i0.ɵɵtemplate(8, CourseComponent_th_8_Template, 2, 2, \"th\", 6);\n        i0.ɵɵtemplate(9, CourseComponent_td_9_Template, 2, 1, \"td\", 7);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(10, 8);\n        i0.ɵɵtemplate(11, CourseComponent_th_11_Template, 2, 0, \"th\", 9);\n        i0.ɵɵtemplate(12, CourseComponent_td_12_Template, 2, 1, \"td\", 10);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(13, 11);\n        i0.ɵɵtemplate(14, CourseComponent_th_14_Template, 2, 0, \"th\", 9);\n        i0.ɵɵtemplate(15, CourseComponent_td_15_Template, 2, 1, \"td\", 10);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(16, 12);\n        i0.ɵɵtemplate(17, CourseComponent_th_17_Template, 2, 0, \"th\", 6);\n        i0.ɵɵtemplate(18, CourseComponent_td_18_Template, 2, 1, \"td\", 13);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(19, 14);\n        i0.ɵɵtemplate(20, CourseComponent_td_20_Template, 2, 1, \"td\", 15);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵtemplate(21, CourseComponent_tr_21_Template, 1, 0, \"tr\", 16);\n        i0.ɵɵtemplate(22, CourseComponent_tr_22_Template, 1, 0, \"tr\", 17);\n        i0.ɵɵtemplate(23, CourseComponent_tr_23_Template, 1, 2, \"tr\", 18);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(24, \"mat-paginator\", 19);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.course == null ? null : ctx.course.description);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"src\", ctx.course == null ? null : ctx.course.iconUrl, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"dataSource\", ctx.lessons);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns)(\"matHeaderRowDefSticky\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matRowDefColumns\", i0.ɵɵpureFunction0(11, _c0));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"length\", ctx.course == null ? null : ctx.course.lessonsCount)(\"pageSize\", 3)(\"pageSizeOptions\", i0.ɵɵpureFunction0(12, _c1));\n      }\n    },\n    dependencies: [i3.NgIf, i4.MatCheckbox, i5.MatPaginator, i6.MatProgressSpinner, i7.MatSort, i7.MatSortHeader, i8.MatTable, i8.MatHeaderCellDef, i8.MatHeaderRowDef, i8.MatColumnDef, i8.MatCellDef, i8.MatRowDef, i8.MatHeaderCell, i8.MatCell, i8.MatHeaderRow, i8.MatRow],\n    styles: [\".course[_ngcontent-%COMP%]{text-align:center;width:390px;margin:0 auto}.course-thumbnail[_ngcontent-%COMP%]{width:150px;margin:20px auto 0;display:block}.description-cell[_ngcontent-%COMP%]{text-align:left;margin:10px auto}.collapsed-detail[_ngcontent-%COMP%]{display:none}.duration-cell[_ngcontent-%COMP%]{text-align:center}.duration-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-size:20px}.spinner-container[_ngcontent-%COMP%]{height:360px;width:390px;position:fixed}.lessons-table[_ngcontent-%COMP%]{min-height:360px;margin-top:10px;width:400px;margin-left:auto;margin-right:auto}.lessons-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:whitesmoke;cursor:pointer}mat-paginator[_ngcontent-%COMP%]{width:400px;margin-bottom:200px}.spinner-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin:130px auto 0}.mat-column-seqNo[_ngcontent-%COMP%]{width:32px;border-right:1px solid black;padding-right:24px;text-align:center}.mat-column-description[_ngcontent-%COMP%]{padding-left:20px;text-align:left}.mat-column-duration[_ngcontent-%COMP%]{font-style:italic}\"]\n  });\n  return CourseComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}